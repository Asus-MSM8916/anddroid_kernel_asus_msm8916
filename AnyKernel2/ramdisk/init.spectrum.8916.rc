# SPECTRUM KERNEL MANAGER
# Ramdisk file for profile based kernel management
# Implimentation inspired by Franco's fku profiles

# Thermal
on boot
	write /sys/module/msm_thermal/parameters/enabled Y
	write /sys/module/msm_thermal/parameters/limit_temp_degC 73
	write /sys/module/msm_thermal/parameters/core_limit_temp_degC 88

# Initialization
on property:sys.boot_completed=1
   # Set default profile on first boot
   exec u:r:init:s0 root root -- /init.spectrum.sh
   exec u:r:su:s0 root root -- /init.spectrum.sh
   # Enable Spectrum support
   setprop spectrum.support 1
   # Add kernel name
   setprop persist.spectrum.kernel GunMetal

# Balance (default profile)
on property:persist.spectrum.profile=0

    # Little Cluster

        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor lionfish

        write /sys/module/workqueue/parameters/power_efficient Y

    # GPU

        write /sys/class/kgsl/kgsl-3d0/devfreq/adrenoboost 0
        write /sys/module/adreno_idler/parameters/adreno_idler_active 1
        write /sys/module/adreno_idler/parameters/adreno_idler_workload 7000
        write /sys/module/adreno_idler/parameters/adreno_idler_idlewait 20

    # I/O Scheduler

        write /sys/block/mmcblk0/queue/read_ahead_kb 512
        write /sys/block/mmcblk0/queue/scheduler maple

	# Thermal

		write /sys/module/msm_thermal/parameters/enabled Y
		write /sys/module/msm_thermal/parameters/limit_temp_degC 73
		write /sys/module/msm_thermal/parameters/core_limit_temp_degC 83

	# Limiter
		write /sys/kernel/msm_limiter/scaling_governor 0:lionfish 1:lionfish 2:lionfish 3:lionfish
		write /sys/kernel/msm_limiter/freq_control 1

# Performance
on property:persist.spectrum.profile=1

    # Little Cluster

        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 533000
        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1209600
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/above_hispeed_delay "19000 1209600:29000"
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/go_hispeed_load 99
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/hispeed_freq 1209600
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads "1 200000:10 400000:20 533000:33 800000:50 998400:70 1094400:75 1152000:80"

        write /sys/module/workqueue/parameters/power_efficient Y

    # GPU

        write /sys/class/kgsl/kgsl-3d0/devfreq/governor msm-adreno-tz
        write /sys/class/kgsl/kgsl-3d0/devfreq/adrenoboost 1
        write /sys/module/adreno_idler/parameters/adreno_idler_active 1
        write /sys/module/adreno_idler/parameters/adreno_idler_workload 6000
        write /sys/module/adreno_idler/parameters/adreno_idler_idlewait 30

    # I/O Scheduler

        write /sys/block/mmcblk0/queue/read_ahead_kb 2048
        write /sys/block/mmcblk0/queue/scheduler cfq

	# Thermal

		write /sys/module/msm_thermal/parameters/enabled Y
		write /sys/module/msm_thermal/parameters/limit_temp_degC 80
		write /sys/module/msm_thermal/parameters/core_limit_temp_degC 90

# Battery
on property:persist.spectrum.profile=2

    # Little Cluster
        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 200000
        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1152000
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/above_hispeed_delay "19000 1401600:99000"
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/go_hispeed_load 98
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/hispeed_freq 998400
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads "1 200000:10 400000:20 533000:33 800000:50 998400:70 1094400:75 1152000:80"

    # GPU

        write /sys/module/adreno_idler/parameters/adreno_idler_active 1
        write /sys/module/adreno_idler/parameters/adreno_idler_workload 8000

    # I/O Scheduler

        write /sys/block/mmcblk0/queue/read_ahead_kb 128
        write /sys/block/mmcblk0/queue/scheduler maple

	# Thermal

		write /sys/module/msm_thermal/parameters/enabled Y
		write /sys/module/msm_thermal/parameters/limit_temp_degC 70
		write /sys/module/msm_thermal/parameters/core_limit_temp_degC 80

	# Limiter
		write /sys/kernel/msm_limiter/scaling_governor 0:lionfish 1:lionfish 2:lionfish 3:lionfish
		write /sys/kernel/msm_limiter/freq_control 1

# Gaming
on property:persist.spectrum.profile=3

    # Little Cluster

        write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
        write /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads "1 200000:10 400000:20 533000:33 800000:50 998400:70 1094400:75 1152000:80"

    # GPU

        write /sys/module/adreno_idler/parameters/adreno_idler_active 0

    # I/O Scheduler

        write /sys/block/mmcblk0/queue/read_ahead_kb 2048
        write /sys/block/mmcblk0/queue/scheduler noop

	# Thermal

		write /sys/module/msm_thermal/parameters/enabled Y
		write /sys/module/msm_thermal/parameters/limit_temp_degC 85
		write /sys/module/msm_thermal/parameters/core_limit_temp_degC 90


